<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>fdp-Wahl-O-Mat - Basis</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<main>
  <h1>ðŸŽ¯ fdp-Wahl-O-Mat</h1>
  <form id="wahlomatForm">
    <!-- Deine Fragen hier unverÃ¤ndert -->
    <section>
      <p>1. Bildungsoffensive starten: Soll der Bund stÃ¤rker in Bildung investieren?</p>
      <label><input type="radio" name="frage1" value="2" required> Ja â€“ Bildung ist Zukunft und braucht Investitionen!</label>
      <label><input type="radio" name="frage1" value="1"> Unentschieden â€“ es kommt auf die genaue Umsetzung an.</label>
      <label><input type="radio" name="frage1" value="0"> Nein â€“ Bildung ist LÃ¤ndersache und der Bund sollte sich heraushalten.</label>
    </section>
    <!-- ... weitere Fragen ... -->
    <section>
      <p>5. Arbeitsmarkt: Soll mehr FlexibilitÃ¤t fÃ¼r Arbeitnehmer und Arbeitgeber geschaffen werden?</p>
      <label><input type="radio" name="frage5" value="2" required> Ja, das fÃ¶rdert Chancen.</label>
      <label><input type="radio" name="frage5" value="1"> Kommt auf die Details an.</label>
      <label><input type="radio" name="frage5" value="0"> Nein, das schwÃ¤cht die Arbeitnehmer.</label>
    </section>

    <!-- HIER: type="submit" sicherstellen -->
    <button type="submit" class="auswerten-btn">Auswertung anzeigen</button>
  </form>

  <div id="ergebnis" aria-live="polite"></div>

  <script>
    const form = document.getElementById('wahlomatForm');
    const ergebnisDiv = document.getElementById('ergebnis');
    const max = 2 * 5;

    form.addEventListener('submit', e => {
      e.preventDefault();
      const formData = new FormData(form);
      const values = {};
      for(let i = 1; i <= 5; i++) {
        values['frage' + i] = formData.get('frage' + i);
      }

      let total = 0;
      for(let i = 1; i <= 5; i++) {
        total += Number(values['frage' + i]);
      }

      const percent = (total / max) * 100;

      let text = '';
      let color = '';

      if(percent >= 85) {
        text = 'ðŸ’› Sie sind voll kompatibel mit der fdp!';
        color = '#FFD700';
      } else if(percent >= 65) {
        text = 'ðŸ”¥ Sie sind der fdp schon sehr nah!';
        color = '#C71585';
      } else if(percent >= 45) {
        text = 'ðŸ’™ Da kann noch was kommen â€“ Sie sind auf dem Weg!';
        color = '#1E90FF';
      } else {
        text = 'ðŸ˜¶ Sie sind noch weit weg von der fdp.';
        color = '#808080';
      }

      ergebnisDiv.innerHTML = `
        <p style="color: ${color}; font-weight: bold; font-size: 1.2rem;">${text}</p>
        <p>Ihre Ãœbereinstimmung: ${percent.toFixed(1)}%</p>
        <div class="balken" aria-label="Ãœbereinstimmungsbalken" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="${percent.toFixed(1)}">
          <div class="balken-inner" style="width: ${percent}%; background-color: ${color};"></div>
        </div>
      `;

      ergebnisDiv.scrollIntoView({behavior: 'smooth'});
    });

    // Optional: URL-Parameter Auswertung beim Laden
    function getUrlParams() {
      const params = {};
      const searchParams = new URLSearchParams(window.location.search);
      for(let i = 1; i <= 5; i++) {
        const val = searchParams.get('frage' + i);
        if(val === null) return null;
        params['frage' + i] = val;
      }
      return params;
    }

    window.addEventListener('load', () => {
      const params = getUrlParams();
      if(params) {
        for(let i = 1; i <= 5; i++) {
          const selector = `input[name=frage${i}][value="${params['frage' + i]}"]`;
          const input = document.querySelector(selector);
          if(input) input.checked = true;
        }
        // Ergebnis anzeigen, wenn URL-Parameter gesetzt sind
        const event = new Event('submit');
        form.dispatchEvent(event);
      }
    });
  </script>
</main>
</body>
</html>
